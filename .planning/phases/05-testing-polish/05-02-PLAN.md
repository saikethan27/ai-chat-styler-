---
phase: 5
plan: 02
wave: 1
autonomous: true
gap_closure: false
---

# Plan 05-02: Gemini Site Testing

## Objective

Test the extension on Gemini (gemini.google.com) with various markdown-rich prompts to ensure proper styling, streaming handling, and dark mode detection.

**What this builds:** Verified compatibility with Gemini's DOM structure and streaming response patterns.

**Why it matters:** Gemini is a primary target site; the extension must work flawlessly there.

## Requirements

- TEST-02: Gemini streaming test

## Tasks

### Task 1: Test Basic Markdown Rendering

**Goal:** Verify all standard markdown elements render correctly on Gemini.

**Implementation:**
1. Navigate to gemini.google.com
2. Enable the extension
3. Test prompts covering:
   - Headers and text
   - Lists (bullet and numbered)
   - Code blocks with syntax highlighting
   - Blockquotes
   - Tables
   - Mixed content
4. Verify each element gets `.claude-styled` class
5. Check visual indicators appear

**Files to modify:**
- None (testing only)
- May fix: content/adapters/gemini.js if selectors need adjustment

**Commit:** fix(05-02): adjust Gemini selectors if needed during testing

### Task 2: Test Streaming Content Handling

**Goal:** Ensure streaming responses are styled smoothly without flicker.

**Implementation:**
1. Generate long responses that stream gradually
2. Observe styling application during streaming
3. Verify no visible flicker or layout shift
4. Check that final content is fully enhanced
5. Monitor console for performance logs

**Files to modify:**
- May fix: content/observer.js if debouncing needs tuning

**Commit:** fix(05-02): optimize streaming debounce timing if needed

### Task 3: Test Thinking State Transitions

**Goal:** Verify Gemini thinking blocks are handled correctly.

**Implementation:**
1. Ask questions that trigger thinking (complex reasoning)
2. Observe thinking block styling
3. Verify transition when thinking completes
4. Check flash animation plays
5. Confirm final response is styled

**Files to modify:**
- May fix: content/adapters/gemini.js thinking detection

**Commit:** fix(05-02): improve thinking state detection if needed

### Task 4: Test Dark Mode Detection

**Goal:** Confirm automatic dark mode detection works on Gemini.

**Implementation:**
1. Test with Google account in dark mode
2. Test with Google account in light mode
3. Verify theme matches Google account setting
4. Check popup shows correct theme status

**Files to modify:**
- May fix: content/adapters/gemini.js dark mode detection

**Commit:** fix(05-02): refine Gemini dark mode detection

### Task 5: Document Gemini Test Results

**Goal:** Create record of Gemini testing outcomes.

**Implementation:**
1. Create GEMINI_TEST_RESULTS.md
2. Document:
   - Test date
   - Chrome version
   - Elements tested
   - Issues found and fixed
   - Screenshots if possible

**Files to create:**
- Create: GEMINI_TEST_RESULTS.md

**Commit:** docs(05-02): document Gemini testing results

## Success Criteria

- [ ] All markdown elements render correctly on Gemini
- [ ] Streaming content styles smoothly
- [ ] Thinking transitions work properly
- [ ] Dark mode detection is accurate
- [ ] No console errors on Gemini

## Dependencies

- Phase 2 (Gemini adapter) must be complete
- Phase 3 (streaming) must be complete
- Phase 4 (popup/state) must be complete

## Notes

- Testing requires Google account with Gemini access
- Some features (thinking) may not appear in all responses
- Document any Gemini UI changes that affect selectors
