---
phase: 04-ui-state-management
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - popup/popup.html
  - popup/popup.css
autonomous: true

must_haves:
  truths:
    - "Popup displays current site hostname and adapter status"
    - "ON/OFF toggle switch is clearly visible and accessible"
    - "Theme selector shows Auto/Light/Dark options"
    - "Status section shows container count and dark mode detection"
    - "UI matches Claude aesthetic (colors, typography, spacing)"
  artifacts:
    - path: "popup/popup.html"
      provides: "Popup markup with toggle, theme selector, and status display"
      contains: ["toggle switch", "theme selector", "status indicators"]
    - path: "popup/popup.css"
      provides: "Claude-styled popup UI with proper colors and interactions"
      contains: [".claude-toggle", ".theme-selector", "status styling"]
  key_links:
    - from: "popup/popup.html"
      to: "popup/popup.css"
      via: "link rel=stylesheet"
      pattern: "popup\.css"
---

<objective>
Create the popup UI HTML and CSS with ON/OFF toggle, theme selector, and status display following Claude's design aesthetic.

Purpose: Provide users with an intuitive interface to control the extension per-site, with clear visual feedback about current state.
Output: Complete popup.html and popup.css with all UI elements styled according to Claude design system.
</objective>

<execution_context>
@C:\Users\madha\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\madha\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@popup/popup.html
@popup/popup.css

## Current State

Current popup.html is a placeholder:
```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Claude UI/UX</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <h1>Claude UI/UX</h1>
    <p>Extension is active</p>
    <p class="note">Full UI coming in Phase 4</p>
  </div>
  <script src="popup.js"></script>
</body>
</html>
```

Current popup.css is minimal:
```css
body {
  width: 200px;
  padding: 16px;
  font-family: system-ui, -apple-system, sans-serif;
}

.container {
  text-align: center;
}

h1 {
  font-size: 16px;
  margin: 0 0 8px;
}

p {
  margin: 0;
  color: #666;
}

.note {
  font-size: 12px;
  color: #999;
  margin-top: 8px;
}
```

## Requirements to Implement

- POPUP-01: ON/OFF toggle
- POPUP-02: Light/Dark theme selector
- POPUP-03: Status indicator (layout)

## Claude Design System Reference

From claude_index.css:
- Primary accent: #d97757 (coral/orange)
- Background light: #faf9f7
- Background dark: #1a1a1a
- Text primary: #1a1a1a (light), #f5f5f5 (dark)
- Text secondary: #6b6b6b (light), #a0a0a0 (dark)
- Border: #e5e5e5 (light), #333333 (dark)
- Success: #2d7d46
- Border radius: 8px (cards), 4px (buttons)

## Popup Dimensions

- Width: 320px (increased from 200px for better usability)
- Padding: 16px
- Font: system-ui, -apple-system, sans-serif
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create popup.html with all UI elements</name>
  <files>popup/popup.html</files>
  <action>
Replace popup.html with complete UI structure:

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Claude UI/UX</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="popup-container">
    <!-- Header -->
    <header class="popup-header">
      <div class="logo">
        <span class="logo-icon">C</span>
        <span class="logo-text">Claude UI</span>
      </div>
      <div class="version">v1.0</div>
    </header>

    <!-- Current Site Section -->
    <section class="site-section">
      <div class="site-label">Current Site</div>
      <div class="site-name" id="current-site">Loading...</div>
    </section>

    <!-- Main Toggle -->
    <section class="toggle-section">
      <div class="toggle-row">
        <span class="toggle-label">Enable Styling</span>
        <label class="toggle-switch">
          <input type="checkbox" id="enable-toggle" checked>
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="toggle-description">
        Apply Claude's markdown styling to this site
      </div>
    </section>

    <!-- Theme Selector -->
    <section class="theme-section">
      <div class="section-label">Theme</div>
      <div class="theme-options">
        <button class="theme-btn active" data-theme="auto" id="theme-auto">
          <span class="theme-icon">A</span>
          <span class="theme-text">Auto</span>
        </button>
        <button class="theme-btn" data-theme="light" id="theme-light">
          <span class="theme-icon">L</span>
          <span class="theme-text">Light</span>
        </button>
        <button class="theme-btn" data-theme="dark" id="theme-dark">
          <span class="theme-icon">D</span>
          <span class="theme-text">Dark</span>
        </button>
      </div>
      <div class="theme-description" id="theme-description">
        Automatically detect site's color scheme
      </div>
    </section>

    <!-- Status Section -->
    <section class="status-section">
      <div class="section-label">Status</div>
      <div class="status-grid">
        <div class="status-item">
          <span class="status-label">Adapter</span>
          <span class="status-value" id="adapter-name">-</span>
        </div>
        <div class="status-item">
          <span class="status-label">Containers</span>
          <span class="status-value" id="container-count">-</span>
        </div>
        <div class="status-item">
          <span class="status-label">Dark Mode</span>
          <span class="status-value" id="dark-mode-status">-</span>
        </div>
        <div class="status-item">
          <span class="status-label">State</span>
          <span class="status-value" id="state-status">Active</span>
        </div>
      </div>
    </section>

    <!-- Debug Section (collapsible) -->
    <section class="debug-section">
      <button class="debug-toggle" id="debug-section-toggle">
        <span>Debug Options</span>
        <span class="debug-arrow">?</span>
      </button>
      <div class="debug-content" id="debug-content">
        <label class="debug-checkbox">
          <input type="checkbox" id="debug-mode">
          <span>Enable debug mode</span>
        </label>
        <div class="debug-hint">
          Shows visual indicators on styled elements
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="popup-footer">
      <a href="#" class="footer-link" id="settings-link">Settings</a>
      <a href="#" class="footer-link" id="help-link">Help</a>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>
```

Key elements to include:
1. Header with logo and version
2. Current site display (shows hostname)
3. ON/OFF toggle switch (checkbox-based for accessibility)
4. Theme selector with 3 buttons (Auto/Light/Dark)
5. Status grid showing adapter, containers, dark mode, state
6. Debug section (collapsible)
7. Footer with links

All elements need proper IDs for JavaScript access:
- enable-toggle: Main ON/OFF switch
- theme-auto, theme-light, theme-dark: Theme buttons
- current-site, adapter-name, container-count, dark-mode-status: Status displays
- debug-mode: Debug checkbox
  </action>
  <verify>
1. Open popup.html in browser to verify structure renders
2. Check all IDs are unique and present
3. Verify semantic HTML structure (sections, headers, etc.)
4. Confirm accessibility: labels associated with inputs, button text present
  </verify>
  <done>
- popup.html has all required UI elements
- Proper IDs for JavaScript access
- Semantic HTML structure
- Accessible form controls
- Collapsible debug section
  </done>
</task>

<task type="auto">
  <name>Task 2: Create popup.css with Claude design styling</name>
  <files>popup/popup.css</files>
  <action>
Replace popup.css with complete Claude-styled UI:

```css
/* ============================================================================
   Claude UI/UX Extension - Popup Styles
   Following Claude design system
   ============================================================================ */

/* CSS Variables for theming */
:root {
  --claude-bg: #faf9f7;
  --claude-bg-secondary: #f5f5f5;
  --claude-text: #1a1a1a;
  --claude-text-secondary: #6b6b6b;
  --claude-border: #e5e5e5;
  --claude-accent: #d97757;
  --claude-accent-hover: #c46a4d;
  --claude-success: #2d7d46;
  --claude-radius: 8px;
  --claude-radius-sm: 4px;
}

/* Reset and base */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  width: 320px;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-size: 14px;
  line-height: 1.5;
  color: var(--claude-text);
  background: var(--claude-bg);
}

/* Container */
.popup-container {
  padding: 16px;
}

/* Header */
.popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--claude-border);
}

.logo {
  display: flex;
  align-items: center;
  gap: 8px;
}

.logo-icon {
  width: 28px;
  height: 28px;
  background: var(--claude-accent);
  color: white;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 14px;
}

.logo-text {
  font-weight: 600;
  font-size: 15px;
}

.version {
  font-size: 12px;
  color: var(--claude-text-secondary);
}

/* Sections */
section {
  margin-bottom: 16px;
}

.site-section {
  background: var(--claude-bg-secondary);
  padding: 12px;
  border-radius: var(--claude-radius);
  margin-bottom: 16px;
}

.site-label {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--claude-text-secondary);
  margin-bottom: 4px;
}

.site-name {
  font-weight: 500;
  font-size: 14px;
  word-break: break-all;
}

/* Toggle Section */
.toggle-section {
  padding: 16px;
  background: white;
  border: 1px solid var(--claude-border);
  border-radius: var(--claude-radius);
}

.toggle-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.toggle-label {
  font-weight: 500;
  font-size: 15px;
}

.toggle-description {
  font-size: 13px;
  color: var(--claude-text-secondary);
}

/* Toggle Switch */
.toggle-switch {
  position: relative;
  display: inline-block;
  width: 48px;
  height: 26px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  transition: 0.2s;
  border-radius: 26px;
}

.toggle-slider:before {
  position: absolute;
  content: "";
  height: 20px;
  width: 20px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: 0.2s;
  border-radius: 50%;
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}

input:checked + .toggle-slider {
  background-color: var(--claude-accent);
}

input:checked + .toggle-slider:before {
  transform: translateX(22px);
}

input:focus + .toggle-slider {
  box-shadow: 0 0 0 2px rgba(217, 119, 87, 0.3);
}

/* Theme Section */
.theme-section {
  padding: 16px;
  background: white;
  border: 1px solid var(--claude-border);
  border-radius: var(--claude-radius);
}

.section-label {
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--claude-text-secondary);
  margin-bottom: 12px;
}

.theme-options {
  display: flex;
  gap: 8px;
  margin-bottom: 8px;
}

.theme-btn {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 12px 8px;
  border: 1px solid var(--claude-border);
  border-radius: var(--claude-radius-sm);
  background: white;
  cursor: pointer;
  transition: all 0.15s ease;
}

.theme-btn:hover {
  border-color: var(--claude-accent);
  background: #fff8f6;
}

.theme-btn.active {
  border-color: var(--claude-accent);
  background: #fff8f6;
  box-shadow: 0 0 0 1px var(--claude-accent);
}

.theme-icon {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--claude-bg-secondary);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 600;
  color: var(--claude-text-secondary);
}

.theme-btn.active .theme-icon {
  background: var(--claude-accent);
  color: white;
}

.theme-text {
  font-size: 12px;
  color: var(--claude-text-secondary);
}

.theme-btn.active .theme-text {
  color: var(--claude-accent);
  font-weight: 500;
}

.theme-description {
  font-size: 12px;
  color: var(--claude-text-secondary);
  text-align: center;
  padding-top: 8px;
  border-top: 1px solid var(--claude-border);
  margin-top: 8px;
}

/* Status Section */
.status-section {
  padding: 16px;
  background: white;
  border: 1px solid var(--claude-border);
  border-radius: var(--claude-radius);
}

.status-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.status-item {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.status-label {
  font-size: 11px;
  color: var(--claude-text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.status-value {
  font-weight: 500;
  font-size: 13px;
}

.status-value.active {
  color: var(--claude-success);
}

.status-value.inactive {
  color: var(--claude-text-secondary);
}

/* Debug Section */
.debug-section {
  border: 1px solid var(--claude-border);
  border-radius: var(--claude-radius);
  overflow: hidden;
}

.debug-toggle {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background: var(--claude-bg-secondary);
  border: none;
  cursor: pointer;
  font-size: 13px;
  font-weight: 500;
  color: var(--claude-text);
}

.debug-toggle:hover {
  background: #ebebeb;
}

.debug-arrow {
  transition: transform 0.2s ease;
}

.debug-section.open .debug-arrow {
  transform: rotate(180deg);
}

.debug-content {
  display: none;
  padding: 16px;
  background: white;
}

.debug-section.open .debug-content {
  display: block;
}

.debug-checkbox {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  font-size: 13px;
}

.debug-checkbox input[type="checkbox"] {
  width: 16px;
  height: 16px;
  accent-color: var(--claude-accent);
}

.debug-hint {
  font-size: 12px;
  color: var(--claude-text-secondary);
  margin-top: 8px;
  margin-left: 24px;
}

/* Footer */
.popup-footer {
  display: flex;
  justify-content: center;
  gap: 16px;
  padding-top: 12px;
  border-top: 1px solid var(--claude-border);
}

.footer-link {
  font-size: 12px;
  color: var(--claude-text-secondary);
  text-decoration: none;
}

.footer-link:hover {
  color: var(--claude-accent);
  text-decoration: underline;
}

/* Disabled state */
.popup-container.disabled .toggle-section,
.popup-container.disabled .theme-section {
  opacity: 0.6;
  pointer-events: none;
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-4px); }
  to { opacity: 1; transform: translateY(0); }
}

section {
  animation: fadeIn 0.2s ease-out;
}
```

Key styling requirements:
1. Use CSS variables for Claude colors
2. Toggle switch uses checkbox hack with sliding animation
3. Theme buttons have active state with accent color
4. Status grid is 2x2 for compact display
5. Debug section is collapsible (CSS handles show/hide with .open class)
6. Smooth transitions on interactive elements
7. Proper focus states for accessibility
8. Disabled state styling for when extension is OFF
  </action>
  <verify>
1. Open popup.html in browser, verify all styles apply
2. Test toggle switch visual states (checked/unchecked)
3. Test theme button active states
4. Verify all spacing and alignment
5. Check that popup width is 320px
6. Test collapsible debug section by adding/removing 'open' class
  </verify>
  <done>
- popup.css has complete Claude styling
- Toggle switch styled with accent color
- Theme buttons have active/hover states
- Status grid displays correctly
- Debug section is collapsible
- All transitions and animations work
- CSS variables defined for maintainability
  </done>
</task>

</tasks>

<verification>
1. Load extension in Chrome and click extension icon
2. Verify popup opens with correct width (320px)
3. Check all sections are visible: site, toggle, theme, status, debug
4. Test toggle switch slides smoothly
5. Test theme buttons highlight when clicked (will need JS for persistence)
6. Verify visual hierarchy matches Claude aesthetic
</verification>

<success_criteria>
- Popup displays at 320px width
- All UI elements present: toggle, theme selector, status grid
- Styling matches Claude design system (colors, spacing, typography)
- Toggle switch animates smoothly
- Theme buttons show active state
- Debug section can expand/collapse
- No visual glitches or layout issues
</success_criteria>

<output>
After completion, create `.planning/phases/04-ui-state-management/04-02-SUMMARY.md`
</output>
